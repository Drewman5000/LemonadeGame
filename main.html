<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>My Lemonade Stand</title>
	<!-- Include Bootstrap CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css">
    <!-- CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="lemonadeGame" id="lemonade">
	    <div class="container-fluid">
            <div class="row">
                <div class="col-md-4" id="navigation">
                    <h1>Inventory</h1>
                    <nav class="nav nav-tabs" role="navigation">
                        <button class="nav-link active" id="pantryButton" aria-selected="true">Pantry</button>
                        <button class="nav-link" id="fridgeButton" aria-selected="false">Fridge</button>
                        <button class="nav-link" id="freezerButton" aria-selected="false">Freezer</button>
                    </nav>
                    <div id="inventoryList"></div>
                </div>
                <div class="col-md-8">
                    <canvas id="lemonadeCanvas"></canvas>
                </div>
            </div>
        </div>
        <div>
            <p>Recipe</p>
            <form>
                <div class="mb-3">
                <label for="lemonType" class="form-label">Lemon Type</label>
                <input type="text" class="form-control" id="lemonType" name="lemonType">
                </div>
                <div class="mb-3">
                <label for="lemonQuantity" class="form-label">Lemon Quantity</label>
                <input type="number" class="form-control" id="lemonQuantity" name="lemonQuantity">
                </div>
                <div class="mb-3">
                <label for="waterType" class="form-label">Water Type</label>
                <input type="text" class="form-control" id="waterType" name="waterType">
                </div>
                <div class="mb-3">
                <label for="waterQuantity" class="form-label">Water Quantity (Cups)</label>
                <input type="number" class="form-control" id="waterQuantity" name="waterQuantity">
                </div>
                <div class="mb-3">
                <label for="sugarType" class="form-label">Sugar Type</label>
                <input type="text" class="form-control" id="sugarType" name="sugarType">
                </div>
                <div class="mb-3">
                <label for="sugarQuantity" class="form-label">Sugar Quantity (Grams)</label>
                <input type="number" class="form-control" id="sugarQuantity" name="sugarQuantity">
                </div>
                <div class="mb-3">
                <label for="iceType" class="form-label">Ice Type</label>
                <input type="text" class="form-control" id="iceType" name="iceType">
                </div>
                <div class="mb-3">
                <label for="iceQuantity" class="form-label">Ice Quantity (Cups)</label>
                <input type="number" class="form-control" id="iceQuantity" name="iceQuantity">
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>
    <div id="loading" class="d-flex justify-content-center align-items-center invisible">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
    </div>
	<!-- Include Bootstrap JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js"></script>
    <script src="lemonade.js"></script>

	<script>
        function homeScreen() {
            // Get references to the interface elements
            const pantryButton = document.getElementById('pantryButton');
            const fridgeButton = document.getElementById('fridgeButton');
            const freezerButton = document.getElementById('freezerButton');
            const inventoryList = document.getElementById('inventoryList');

            function capitalizeFirstLetter(str) {
                const regex = /^[a-z]+$/;
                if (regex.test(str)) {
                    return str.charAt(0).toUpperCase() + str.slice(1);
                } else {
                    return str;
                }
            }

            function buildDisplay(item, storageLocation) {
                const itemLi = document.createElement("li");
                const location = capitalizeFirstLetter(storageLocation);
                itemLi.classList.add("inventory-item");
                itemLi.textContent = `${item}: ${inventory[item].quantity}`;
                document.querySelector(`#${storageLocation}`).appendChild(itemLi);
            }

            function loadFridgeView() {
                loadingStart();
                inventoryList.innerHTML = `<p>Fridge items:</p><ul id="fridge"></ul>`;
                for (const item in inventory) {
                    if (inventory[item].storageLocation === "fridge") {
                        buildDisplay(item, "fridge");
                    }
                }
                loadingEnd();
            }

            function loadFreezerView() {
                loadingStart();
                inventoryList.innerHTML = `<p>Freezer items:</p><ul id="freezer"></ul>`;
                for (const item in inventory) {
                    if (inventory[item].storageLocation === "freezer") {
                        buildDisplay(item, "freezer");
                    }
                }
                loadingEnd();
            }

            function loadPantryView() {
                loadingStart();
                inventoryList.innerHTML = `<p>Pantry items:</p><ul id="pantry"></ul>`;
                for (const item in inventory) {
                    if (inventory[item].storageLocation === "pantry") {
                        buildDisplay(item, "pantry");
                    }
                }
                loadingEnd();
            }

            // Event Listeners
            freezerButton.addEventListener('click', loadFreezerView);
            fridgeButton.addEventListener('click', loadFridgeView);
            pantryButton.addEventListener('click', loadPantryView);
            freezerButton.addEventListener('touchstart', loadFreezerView);
            fridgeButton.addEventListener('touchstart', loadFridgeView);
            pantryButton.addEventListener('touchstart', loadPantryView);
        };
    // Loading Functions

        function activeTabChange(e) {
            var navLinks = document.querySelectorAll(".nav .nav-link");
            navLinks.forEach(function(linkEl) {
                linkEl.classList.remove("active");
                linkEl.setAttribute('aria-selected', 'false');
            });
            e.target.classList.add("active");
            e.target.setAttribute('aria-selected', 'true');
        }
    // Loading Transitions
        function loadingStart() {
            document.getElementById("loading").classList.remove("invisible");
        }

        function loadingEnd() {
            document.getElementById("loading").classList.add("invisible");
        }
    // Event Handlers
        function clickEventHandler(e) {
            // TODO: Add cancel button to recipe form
            if(e.target.matches("#cancel-changes")) {
                document.getElementById("formReset").reset();
            }
        }

        function navClickEventHandler(e) {
            if(e.target.matches(".nav-link")) {
                activeTabChange(e);
            }
        }

    // Event Listeners
        // document.getElementById('pantryButton');
        // document.getElementById('fridgeButton');
        // document.getElementById('freezerButton');
        // document.getElementById('inventoryList');
        document.getElementById("lemonade").addEventListener("click", clickEventHandler);
        document.getElementById("navigation").addEventListener("click", navClickEventHandler);
        document.addEventListener("DOMContentLoaded", homeScreen);
	</script>
</body>
</html>